<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="èƒŒæ™¯ ä¹‹å‰ä¹°äº†ä¸ªæ ‘è“æ´¾2ï¼Œé—²ç½®äº†å¾ˆä¹…ï¼Œæœ€è¿‘æ­£å¥½æœ‰NASéœ€æ±‚ï¼Œå°±æ‰“ç®—æ‹¿å®ƒè£…ä¸ªOpenMediaVaultç©ç©ã€‚\nå®‰è£…è¿‡ç¨‹ä¸è¡¨ã€‚\näº‹å®ä¸Šæ˜¯åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œé‡åˆ°çš„æŸä¸ªé—®é¢˜æ¯”è¾ƒå¥‡è‘©ï¼Œå°±æ‹¿æ¥åˆ†äº«äº†ã€‚\n"><title>Pi2ç‰ˆOMVçš„Monitè¿æ¥é”™è¯¯çš„é—®é¢˜</title>
<link rel=canonical href=/posts/error-connecting-to-the-monit-daemon-in-omv-for-pi2/><link rel=stylesheet href=/scss/style.min.a1b1ba438e860c87798b68a93abe1acc0cbdab582cb899c9f3bf2afa7be8e373.css><meta property='og:title' content="Pi2ç‰ˆOMVçš„Monitè¿æ¥é”™è¯¯çš„é—®é¢˜"><meta property='og:description' content="èƒŒæ™¯ ä¹‹å‰ä¹°äº†ä¸ªæ ‘è“æ´¾2ï¼Œé—²ç½®äº†å¾ˆä¹…ï¼Œæœ€è¿‘æ­£å¥½æœ‰NASéœ€æ±‚ï¼Œå°±æ‰“ç®—æ‹¿å®ƒè£…ä¸ªOpenMediaVaultç©ç©ã€‚\nå®‰è£…è¿‡ç¨‹ä¸è¡¨ã€‚\näº‹å®ä¸Šæ˜¯åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œé‡åˆ°çš„æŸä¸ªé—®é¢˜æ¯”è¾ƒå¥‡è‘©ï¼Œå°±æ‹¿æ¥åˆ†äº«äº†ã€‚\n"><meta property='og:url' content='/posts/error-connecting-to-the-monit-daemon-in-omv-for-pi2/'><meta property='og:site_name' content="KeePwn's Notes"><meta property='og:type' content='article'><meta property='article:section' content='Posts'><meta property='article:tag' content='raspberrypi omv monit ntp'><meta property='article:tag' content='raspberrypi'><meta property='article:tag' content='omv'><meta property='article:tag' content='monit'><meta property='article:tag' content='ntp'><meta property='article:published_time' content='2015-12-17T00:00:00+00:00'><meta property='article:modified_time' content='2024-10-16T15:41:27+00:00'><meta name=twitter:title content="Pi2ç‰ˆOMVçš„Monitè¿æ¥é”™è¯¯çš„é—®é¢˜"><meta name=twitter:description content="èƒŒæ™¯ ä¹‹å‰ä¹°äº†ä¸ªæ ‘è“æ´¾2ï¼Œé—²ç½®äº†å¾ˆä¹…ï¼Œæœ€è¿‘æ­£å¥½æœ‰NASéœ€æ±‚ï¼Œå°±æ‰“ç®—æ‹¿å®ƒè£…ä¸ªOpenMediaVaultç©ç©ã€‚\nå®‰è£…è¿‡ç¨‹ä¸è¡¨ã€‚\näº‹å®ä¸Šæ˜¯åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œé‡åˆ°çš„æŸä¸ªé—®é¢˜æ¯”è¾ƒå¥‡è‘©ï¼Œå°±æ‹¿æ¥åˆ†äº«äº†ã€‚\n"><link rel="shortcut icon" href=/favicon.png></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu6864098431101011839.png width=300 height=300 class=site-logo loading=lazy alt=Avatar>
</a><span class=emoji>ğŸš€</span></figure><div class=site-meta><h1 class=site-name><a href=/>KeePwn's Notes</a></h1><h2 class=site-description>æˆ‘å«ç‹å®‰å…¨ï¼Œæ‰¾æˆ‘æœ€å®‰å…¨</h2></div></header><ol class=menu-social><li><a href=https://github.com/keepwn target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/about/><svg class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg>
<span>About</span></a></li><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-sun-high" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M14.828 14.828A4 4 0 109.172 9.172a4 4 0 005.656 5.656z"/><path d="M6.343 17.657l-1.414 1.414"/><path d="M6.343 6.343 4.929 4.929"/><path d="M17.657 6.343l1.414-1.414"/><path d="M17.657 17.657l1.414 1.414"/><path d="M4 12H2"/><path d="M12 4V2"/><path d="M20 12h2"/><path d="M12 20v2"/></svg>
<svg class="icon icon-tabler icon-tabler-moon-stars" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 3c.132.0.263.0.393.0a7.5 7.5.0 007.92 12.446A9 9 0 1112 2.992z"/><path d="M17 4a2 2 0 002 2 2 2 0 00-2 2 2 2 0 00-2-2 2 2 0 002-2"/><path d="M19 11h2m-1-1v2"/></svg>
<span>Dark Mode</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ol><li><ol><li><a href=#èƒŒæ™¯>èƒŒæ™¯</a></li><li><a href=#æ—å°½æ°´æº>æ—å°½æ°´æº</a></li><li><a href=#åˆä»¿ä½›è‹¥æœ‰å…‰>åˆä»¿ä½›è‹¥æœ‰å…‰</a></li><li><a href=#å¤è¡Œæ•°åæ­¥>å¤è¡Œæ•°åæ­¥</a></li><li><a href=#è±ç„¶å¼€æœ—>è±ç„¶å¼€æœ—</a></li><li><a href=#å‚è€ƒ>å‚è€ƒ</a></li></ol></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/categories/homelab/ style=background-color:#2a9d8f;color:#fff>HomeLab</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/posts/error-connecting-to-the-monit-daemon-in-omv-for-pi2/>Pi2ç‰ˆOMVçš„Monitè¿æ¥é”™è¯¯çš„é—®é¢˜</a></h2></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>2015/12/17</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>3 minute read</time></div></footer></div></header><section class=article-content><h2 id=èƒŒæ™¯>èƒŒæ™¯</h2><p>ä¹‹å‰ä¹°äº†ä¸ªæ ‘è“æ´¾2ï¼Œé—²ç½®äº†å¾ˆä¹…ï¼Œæœ€è¿‘æ­£å¥½æœ‰NASéœ€æ±‚ï¼Œå°±æ‰“ç®—æ‹¿å®ƒè£…ä¸ª<code>OpenMediaVault</code>ç©ç©ã€‚</p><p>å®‰è£…è¿‡ç¨‹ä¸è¡¨ã€‚</p><p>äº‹å®ä¸Šæ˜¯åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œé‡åˆ°çš„æŸä¸ªé—®é¢˜æ¯”è¾ƒå¥‡è‘©ï¼Œå°±æ‹¿æ¥åˆ†äº«äº†ã€‚</p><h2 id=æ—å°½æ°´æº>æ—å°½æ°´æº</h2><p>åœ¨ç½‘é¡µç«¯å¯¹OMVè¿›è¡Œé…ç½®æ—¶ï¼Œç»å¸¸ä¼šé‡åˆ°ä¸€ä¸ªå¼¹çª—<code>monit: Cannot connect to the monit daemon. Did you start it with http support?</code>ã€‚</p><p>è¯¦ç»†é”™è¯¯ä»£ç å¦‚ä¸‹ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>exception</span> <span class=s1>&#39;OMVException&#39;</span> <span class=n>with</span> <span class=n>message</span> <span class=s1>&#39;Failed to execute command &#39;</span><span class=k>export</span> <span class=n>LANG</span><span class=o>=</span><span class=n>C</span><span class=p>;</span> <span class=n>monit</span> <span class=n>restart</span> <span class=n>collectd</span> <span class=mi>2</span><span class=o>&gt;&amp;</span><span class=mi>1</span><span class=s1>&#39;: monit: Cannot connect to the monit daemon. Did you start it with http support?&#39;</span> <span class=ow>in</span> <span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>share</span><span class=o>/</span><span class=n>php</span><span class=o>/</span><span class=n>openmediavault</span><span class=o>/</span><span class=n>monit</span><span class=o>.</span><span class=n>inc</span><span class=p>:</span><span class=mi>113</span>
</span></span><span class=line><span class=cl><span class=n>Stack</span> <span class=n>trace</span><span class=p>:</span>
</span></span><span class=line><span class=cl><span class=c1>#0 /usr/share/php/openmediavault/monit.inc(70): OMVMonit-&gt;action(&#39;restart&#39;, &#39;collectd&#39;, false)</span>
</span></span><span class=line><span class=cl><span class=c1>#1 /usr/share/openmediavault/engined/module/collectd.inc(53): OMVMonit-&gt;restart(&#39;collectd&#39;)</span>
</span></span><span class=line><span class=cl><span class=c1>#2 /usr/share/openmediavault/engined/rpc/config.inc(206): OMVModuleCollectd-&gt;startService()</span>
</span></span><span class=line><span class=cl><span class=c1>#3 [internal function]: OMVRpcServiceConfig-&gt;applyChanges(Array, Array)</span>
</span></span><span class=line><span class=cl><span class=c1>#4 /usr/share/php/openmediavault/rpcservice.inc(125): call_user_func_array(Array, Array)</span>
</span></span><span class=line><span class=cl><span class=c1>#5 /usr/share/php/openmediavault/rpcservice.inc(158): OMVRpcServiceAbstract-&gt;callMethod(&#39;applyChanges&#39;, Array, Array)</span>
</span></span><span class=line><span class=cl><span class=c1>#6 /usr/share/openmediavault/engined/rpc/config.inc(224): OMVRpcServiceAbstract-&gt;callMethodBg(&#39;applyChanges&#39;, Array, Array)</span>
</span></span><span class=line><span class=cl><span class=c1>#7 [internal function]: OMVRpcServiceConfig-&gt;applyChangesBg(Array, Array)</span>
</span></span><span class=line><span class=cl><span class=c1>#8 /usr/share/php/openmediavault/rpcservice.inc(125): call_user_func_array(Array, Array)</span>
</span></span><span class=line><span class=cl><span class=c1>#9 /usr/share/php/openmediavault/rpc.inc(79): OMVRpcServiceAbstract-&gt;callMethod(&#39;applyChangesBg&#39;, Array, Array)</span>
</span></span><span class=line><span class=cl><span class=c1>#10 /usr/sbin/omv-engined(500): OMVRpc::exec(&#39;Config&#39;, &#39;applyChangesBg&#39;, Array, Array, 1)</span>
</span></span><span class=line><span class=cl><span class=c1>#11 {main}</span>
</span></span></code></pre></td></tr></table></div></div><p>sshåˆ°<code>OMV</code>ç»ˆç«¯ï¼Œè¾“å…¥å‘½ä»¤ï¼š<code>monit status</code>ï¼Œä¼¼ä¹é”™è¯¯ä¿¡æ¯ä¹Ÿä¸€æ ·ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>monit: error connecting to the monit daemon
</span></span></code></pre></td></tr></table></div></div><p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ<code>OMV</code>å°±æ— æ³•åº”ç”¨é…ç½®ï¼Œå¿…é¡»è§£å†³è¿™é—®é¢˜ã€‚</p><h2 id=åˆä»¿ä½›è‹¥æœ‰å…‰>åˆä»¿ä½›è‹¥æœ‰å…‰</h2><p>äºæ˜¯å»googleä¸Šæ‰¾å•Šï¼Œæ‰¾å•Šï¼Œç»ˆäºæ‰¾åˆ°ä¸€ç¯‡å¸–å­ï¼Œé‡åˆ°äº†<a class=link href=http://forums.openmediavault.org/index.php/Thread/8973-Failed-to-execute-command-export-LANG-C-monit-restart-collectd-2-1-monit/ title="Failed to execute command 'export LANG=C; monit restart collectd 2>&amp;1': monit" target=_blank rel=noopener>ç›¸ä¼¼çš„é—®é¢˜</a>ï¼ˆç«Ÿç„¶ä¸æ˜¯StackOverflowï¼Œå·®è¯„ï¼)</p><div class="admonition quote"><div class="details-summary admonition-title"><i class='icon fas fa-quote-right fa-fw'></i>
Quote</div><div class=details-content><div class=admonition-content><p>Because ntpdate is installed in the image. Both ntp server and ntpdate cannot be installed at the same time. Also, the config for the ntp server does not work&mldr;.</p><p>apt-get &ndash;purge remove ntpdate</p><p>Then in the OMV web gui set your timezone because after these changes you cannot set it again.</p><p>then edit /etc/ntp.conf:</p><p>remove these lines:
server 127.127.1.0 # Local clock
fudge 127.127.1.0 stratum 12
server pool.ntp.org iburst</p><p>And replace with these:
server 0.no.pool.ntp.org iburst
server 1.no.pool.ntp.org iburst
server 2.no.pool.ntp.org iburst
server 3.no.pool.ntp.org iburst</p><p>Then you can:
service ntp restart</p><p>Do not disable/enable in the OMV web gui again. The mkconf file for the ntp service will overwrite thesechanges. There need to be some updates so it works properly with the rpi 2.</p><p>Your logs files and dates at boot will be all messed up with wrong dates until you install a RTC module. After boot it takes some minutes before the ntp server will update the time/date. With a RTC module everything is perfect at boot.</p></div></div></div><p>æ€»ç»“å‡ ç‚¹å°±æ˜¯ï¼š</p><ul><li><code>Monit</code>çš„é”™è¯¯å’Œç³»ç»Ÿæ—¶é—´æœ‰å…³<ul><li>ï¼ˆæ£€æŸ¥äº†ä¸€ä¸‹ï¼Œç¡®å®ç³»ç»Ÿå½“å‰æ—¶é—´é”™è¯¯ï¼‰</li></ul></li><li><code>ntpdate</code>ä¸<code>ntp server</code>æœ‰å†²çªï¼Œä¸èƒ½åŒæ—¶å®‰è£…<ul><li>ï¼ˆæ£€æŸ¥äº†ä¸€ä¸‹ï¼ŒntpæœåŠ¡å¯åŠ¨å¤±è´¥ï¼‰</li></ul></li><li><code>OMV</code>è‡ªå¸¦çš„ntpé…ç½®<code>/etc/ntp.conf</code>æœ‰é”™è¯¯</li><li>ä½ åº”è¯¥å®‰è£…<code>RTC</code>æ¨¡å—</li></ul><h2 id=å¤è¡Œæ•°åæ­¥>å¤è¡Œæ•°åæ­¥</h2><p>æŒ‰ç…§å‰é¢è¿™ä½è´¤è€…çš„å»ºè®®ï¼Œæˆ‘åˆ†åˆ«è¿›è¡Œäº†ä¸€ä¸‹å‡ ä¸ªæµ‹è¯•ï¼š</p><ul><li>æµ‹è¯•ä¸€: æ‰‹åŠ¨ä¿®æ”¹å½“å‰æ—¶é—´ï¼Œå¸è½½<code>ntpdate</code>ï¼Œå…³é—­<code>ntp</code>æœåŠ¡<ul><li>é‡å¯ä»¥åï¼Œæ—¶é—´ä¸¢å¤±</li></ul></li><li>æµ‹è¯•äºŒ: å¸è½½<code>ntpdate</code>ï¼Œä¸ä¿®æ”¹<code>ntp</code>é…ç½®æ–‡ä»¶<ul><li><code>ntp</code>æœåŠ¡æ­£å¸¸å¯åŠ¨ï¼Œæ—¶é—´åŒæ­¥æ­£ç¡®</li><li>é‡å¯ä»¥åï¼Œ<code>ntp</code>æœåŠ¡æ­£å¸¸å¯åŠ¨ï¼Œæ—¶é—´æ— æ³•åŒæ­¥</li></ul></li><li>æµ‹è¯•ä¸‰: å¸è½½<code>ntpdate</code>ï¼Œä¿®æ”¹<code>ntp</code>é…ç½®æ–‡ä»¶<ul><li><code>ntp</code>æœåŠ¡æ­£å¸¸å¯åŠ¨ï¼Œæ—¶é—´åŒæ­¥æ­£ç¡®</li><li>é‡å¯ä»¥åï¼Œ<code>ntp</code>æœåŠ¡æ­£å¸¸å¯åŠ¨ï¼Œæ—¶é—´æ— æ³•åŒæ­¥</li></ul></li><li>æµ‹è¯•å››: è¿è¡Œ<code>ntpdate</code>ï¼Œå¼ºåˆ¶åŒæ­¥<ul><li>æ—¶é—´åŒæ­¥æ­£ç¡®</li><li>é‡å¯ä»¥åï¼Œ<code>ntp</code>æœåŠ¡ä¸èƒ½æ­£å¸¸å¯åŠ¨ï¼Œæ—¶é—´æ— æ³•åŒæ­¥</li></ul></li></ul><p>æµ‹è¯•åå‘ç°ï¼Œå› ä¸ºæ ‘è“æ´¾æœ¬èº«çš„ç¡¬ä»¶é™åˆ¶ï¼Œç³»ç»Ÿé‡å¯åä¼šä¸¢å¤±å½“å‰æ—¶é—´ã€‚</p><p>å°½ç®¡å¼€å¯äº†<code>ntp</code>æœåŠ¡ï¼Œä½†æ˜¯å¦‚æœç³»ç»Ÿå½“å‰æ—¶é—´ä¸çœŸå®æ—¶é—´è·¨åº¦å¤ªå¤§ï¼Œåˆ™ä¸ä¼šè¿›è¡ŒåŒæ­¥ã€‚</p><p>æ‰€ä»¥åªèƒ½æ”¾å¼ƒ<code>ntp server</code>ï¼Œè½¬è€Œä½¿ç”¨<code>ntpdate</code>æ¥å¼ºåˆ¶åŒæ­¥æ—¶é—´ï¼Œå¹¶è®¾ç½®å¼€æœºå¯åŠ¨ã€‚</p><p>ä»£ç å¦‚ä¸‹ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># è®¾ç½®å¼€æœºåŒæ­¥æ—¶é—´ï¼Œæ³¨æ„: æ·»åŠ çš„ä»£ç å¿…é¡»åœ¨`exit 0`ä¹‹å‰
</span></span><span class=line><span class=cl>echo &#39;/usr/sbin/ntpdate 0.cn.pool.ntp.org&#39; &gt;&gt; /etc/rc.local
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl># è®¾ç½®åŒæ­¥ä»»åŠ¡ï¼Œæ¯éš”5åˆ†é’ŸåŒæ­¥ä¸€æ¬¡æ—¶é—´
</span></span><span class=line><span class=cl># ç¼–è¾‘crontabï¼Œå¹¶ä¿å­˜
</span></span><span class=line><span class=cl>crontab -e
</span></span><span class=line><span class=cl>*/5 * * * * /usr/sbin/ntpdate 0.cn.pool.ntp.org
</span></span></code></pre></td></tr></table></div></div><p>é‡å¯ç³»ç»Ÿï¼Œç³»ç»Ÿæ—¶é—´å·²ç»æ­£ç¡®äº†ã€‚</p><p>åœ¨ç½‘é¡µç«¯å¯¹<code>OMV</code>é‡æ–°è¿›è¡Œé…ç½®ã€‚WTFï¼Œæ€ä¹ˆè¿˜æ˜¯<code>monit</code>è¿™ä¸ªé—®é¢˜ï¼</p><h2 id=è±ç„¶å¼€æœ—>è±ç„¶å¼€æœ—</h2><p>ç™»å…¥ç»ˆç«¯ï¼Œé‡æ–°è¿›è¡Œæ£€æŸ¥ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>root@raspberrypi:~# date
</span></span><span class=line><span class=cl>Dec <span class=m>16</span> 11:12:04 CST <span class=m>2015</span>
</span></span><span class=line><span class=cl>root@raspberrypi:~# monit status
</span></span><span class=line><span class=cl>monit: error connecting to the monit daemon
</span></span></code></pre></td></tr></table></div></div><p>åˆ°è¿™é‡Œæ—¶ï¼Œæˆ‘å½“æ—¶ç¡®å®å¾ˆç–‘æƒ‘ï¼Œæ˜æ˜ç³»ç»Ÿæ—¶é—´å·²ç»æ­£ç¡®äº†ï¼Œä¸ºä»€ä¹ˆ<code>monit</code>è¿˜æ˜¯æŠ¥é”™å‘¢ã€‚</p><p>çªç„¶çµå…‰ä¹ç°ï¼Œé‡æ–°å¯åŠ¨<code>monit</code>æœåŠ¡ï¼Œç„¶ååå‡ ç§’è¿‡åï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>root@raspberrypi:~# monit status
</span></span><span class=line><span class=cl>The Monit daemon 5.4 uptime: 18m 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>System <span class=s1>&#39;localhost&#39;</span>
</span></span><span class=line><span class=cl>  status                            Running
</span></span><span class=line><span class=cl>  monitoring status                 Monitored
</span></span><span class=line><span class=cl>  load average                      <span class=o>[</span>0.00<span class=o>]</span> <span class=o>[</span>0.01<span class=o>]</span> <span class=o>[</span>0.05<span class=o>]</span>
</span></span><span class=line><span class=cl>  cpu                               0.0%us 0.1%sy 0.0%wa
</span></span><span class=line><span class=cl>  memory usage                      <span class=m>55424</span> kB <span class=o>[</span>5.5%<span class=o>]</span>
</span></span><span class=line><span class=cl>  swap usage                        <span class=m>0</span> kB <span class=o>[</span>0.0%<span class=o>]</span>
</span></span><span class=line><span class=cl>  data collected                    <span class=m>16</span> Dec <span class=m>2015</span> 11:12:17
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Process <span class=s1>&#39;collectd&#39;</span>
</span></span><span class=line><span class=cl>  status                            Running
</span></span><span class=line><span class=cl>  monitoring status                 Monitored
</span></span><span class=line><span class=cl>  pid                               <span class=m>2535</span>
</span></span><span class=line><span class=cl>  parent pid                        <span class=m>1</span>
</span></span><span class=line><span class=cl>  uptime                            18m 
</span></span><span class=line><span class=cl>  children                          <span class=m>0</span>
</span></span><span class=line><span class=cl>  memory kilobytes                  <span class=m>4224</span>
</span></span><span class=line><span class=cl>  memory kilobytes total            <span class=m>4224</span>
</span></span><span class=line><span class=cl>  memory percent                    0.4%
</span></span><span class=line><span class=cl>  memory percent total              0.4%
</span></span><span class=line><span class=cl>  cpu percent                       0.0%
</span></span><span class=line><span class=cl>  cpu percent total                 0.0%
</span></span><span class=line><span class=cl>  data collected                    <span class=m>16</span> Dec <span class=m>2015</span> 11:12:17
</span></span></code></pre></td></tr></table></div></div><p>åœ¨æ­¤ä¸ªäººåˆ†æï¼Œåœ¨<code>monit</code>æœåŠ¡å¯åŠ¨æ—¶ï¼Œç³»ç»Ÿæ—¶é—´è¿˜æœªåŒæ­¥ï¼Œæ‰€ä»¥<code>monit</code>åˆå§‹åŒ–å¤±è´¥ã€‚åªè¦ä¿è¯åœ¨æ—¶é—´åŒæ­¥åï¼Œå†é‡å¯<code>monit</code>æœåŠ¡åº”è¯¥å°±å¯ä»¥äº†ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># åœ¨å¼ºåˆ¶åŒæ­¥æ—¶é—´åï¼Œå†é‡å¯monitæœåŠ¡
</span></span><span class=line><span class=cl>echo &#39;/etc/init.d/monit restart&#39; &gt;&gt; /etc/rc.local
</span></span></code></pre></td></tr></table></div></div><p>é‡å¯ç³»ç»Ÿï¼Œä¸€åˆ‡æ­£å¸¸ã€‚ENDï¼</p><h2 id=å‚è€ƒ>å‚è€ƒ</h2><ul><li><a class=link href=http://forums.openmediavault.org/index.php/Thread/8973-Failed-to-execute-command-export-LANG-C-monit-restart-collectd-2-1-monit/ target=_blank rel=noopener>http://forums.openmediavault.org/index.php/Thread/8973-Failed-to-execute-command-export-LANG-C-monit-restart-collectd-2-1-monit/</a></li><li><a class=link href=http://forums.openmediavault.org/index.php/Thread/8770-RPi-2-RTC-module-from-unruly-Stepchild-to-Wunderkind/ target=_blank rel=noopener>http://forums.openmediavault.org/index.php/Thread/8770-RPi-2-RTC-module-from-unruly-Stepchild-to-Wunderkind/</a></li><li><a class=link href="https://www.raspberrypi.org/forums/viewtopic.php?f=91&amp;t=83344" target=_blank rel=noopener>https://www.raspberrypi.org/forums/viewtopic.php?f=91&t=83344</a></li></ul></section><footer class=article-footer><section class=article-tags><a href=/tags/raspberrypi-omv-monit-ntp/>Raspberrypi Omv Monit Ntp</a>
<a href=/tags/raspberrypi/>Raspberrypi</a>
<a href=/tags/omv/>Omv</a>
<a href=/tags/monit/>Monit</a>
<a href=/tags/ntp/>Ntp</a></section><section class=article-copyright><svg class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span></section><section class=article-lastmod><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<span>Last updated on 2024/10/16</span></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>Related content</h2><div class=related-content><div class="flex article-list--tile"><article class=has-image><a href=/posts/build-home-cloud-center-for-it/><div class=article-image><img src=/images/banner-build-home-cloud-center-for-IT.png loading=lazy data-key=build-home-cloud-center-for-IT data-hash=/images/banner-build-home-cloud-center-for-IT.png></div><div class=article-details><h2 class=article-title>æ„å»ºé€‚åˆç¨‹åºå‘˜çš„ç§æœ‰äº‘</h2></div></a></article><article><a href=/posts/see-the-big-world-on-openwrt/><div class=article-details><h2 class=article-title>Openwrtä¸Šå®ç°é€æ˜ä»£ç†</h2></div></a></article><article><a href=/posts/crossflashing-the-fujitsu-d2607/><div class=article-details><h2 class=article-title>å¯Œå£«é€šD2607-A11åˆ·ITæ¨¡å¼</h2></div></a></article><article><a href=/posts/moving-hyperv-to-esxi/><div class=article-details><h2 class=article-title>ä»Hyper-Vè¿ç§»åˆ°ESXIçš„è¡€æ³ªå²</h2></div></a></article><article><a href=/posts/route-traffic-selectively-by-domain-on-openwrt/><div class=article-details><h2 class=article-title>Openwrtä¸Šä½¿ç”¨dnsmasqå’Œipsetå®ç°åŸŸååˆ†æµ</h2></div></a></article></div></div></aside><script src=https://utteranc.es/client.js repo=keepwn/blog-comments issue-term=pathname crossorigin=anonymous async></script><style>.utterances{max-width:unset}</style><script>let utterancesLoaded=!1;function setUtterancesTheme(e){let t=document.querySelector(".utterances iframe");t&&t.contentWindow.postMessage({type:"set-theme",theme:`github-${e}`},"https://utteranc.es")}addEventListener("message",e=>{if(e.origin!=="https://utteranc.es")return;utterancesLoaded=!0,setUtterancesTheme(document.documentElement.dataset.scheme)}),window.addEventListener("onColorSchemeChange",e=>{if(!utterancesLoaded)return;setUtterancesTheme(e.detail)})</script><footer class=site-footer><section class=copyright>&copy;
2014 -
2024 KeePwn's Notes</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.27.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>