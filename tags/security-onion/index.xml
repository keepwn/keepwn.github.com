<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
    <channel>
        <title>Security-Onion on KeePwn&#39;s Notes</title>
        <link>/tags/security-onion/</link>
        <description>Recent content in Security-Onion on KeePwn&#39;s Notes</description>
        <generator>Hugo -- gohugo.io</generator>
        <language>en-us</language>
        <lastBuildDate>Sun, 23 Jul 2023 13:57:02 +0000</lastBuildDate><atom:link href="/tags/security-onion/index.xml" rel="self" type="application/rss+xml" /><item>
        <title>Security-Onion-2分布式实践之安装篇</title>
        <link>/posts/security-onion-2-distributed-practice-install/</link>
        <pubDate>Sat, 20 Mar 2021 00:00:00 +0000</pubDate>
        
        <guid>/posts/security-onion-2-distributed-practice-install/</guid>
        <description>&lt;img src="/images/banner-security-onion-2-distributed-practice-install.png" alt="Featured image of post Security-Onion-2分布式实践之安装篇" /&gt;&lt;h2 id=&#34;前言&#34;&gt;前言
&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;Security Onion （以下称安全洋葱）是一款免费且开源的，用于威胁发现、企业安全监视和日志管理的 Linux 发行版本。
目前，安全洋葱已经迭代至 2.X，与 1.X 版本不同，2.X 版本基于容器开发，实现了将各个组件和服务容器化，更易于使用者部署和定制。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;安全洋葱的安装较为简单，网络上也有诸多的 ALL IN ONE 的安装教程，但考虑到这些部署方式不太适合生产环境使用，所以本篇主要讲述如何在生产环境分布式部署安全洋葱系统。本篇并不涉及系统的调优，如果你此前已经安装并部署了安全洋葱，可以跳过此章节。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;本文中使用的安全洋葱版本为 v2.3.30（截至本文编写时）。&lt;/strong&gt;&lt;/p&gt;
&lt;h2 id=&#34;准备工作&#34;&gt;准备工作
&lt;/h2&gt;&lt;p&gt;官方文档建议采用&lt;code&gt;标准的分布式部署方式&lt;/code&gt;进行部署安全洋葱，至少以下三个节点：&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;节点类型&lt;/th&gt;
          &lt;th&gt;说明&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;manager node&lt;/td&gt;
          &lt;td&gt;主要节点，负责接收采集到的原始数据&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;forward node&lt;/td&gt;
          &lt;td&gt;流量分析节点，也叫 sensor-node&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;search-node&lt;/td&gt;
          &lt;td&gt;搜索节点，存储 ES 数据&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;我部署了 4 个节点，大家根据实际情况进行扩展：&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;节点&lt;/th&gt;
          &lt;th&gt;IP&lt;/th&gt;
          &lt;th&gt;配置&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td&gt;security-manager&lt;/td&gt;
          &lt;td&gt;10.10.0.1&lt;/td&gt;
          &lt;td&gt;8 cores, 16g memory, 200g disk&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;security-sensor&lt;/td&gt;
          &lt;td&gt;10.10.0.100&lt;/td&gt;
          &lt;td&gt;8 cores, 32g memory, 12t disk&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;security-search-1&lt;/td&gt;
          &lt;td&gt;10.10.0.11&lt;/td&gt;
          &lt;td&gt;8 cores, 16g memory, 2t disk&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td&gt;security-search-2&lt;/td&gt;
          &lt;td&gt;10.10.0.12&lt;/td&gt;
          &lt;td&gt;8 cores, 16g memory, 2t disk&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;架构大致如下：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/images/so-distributed.webp&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;so-distributed.webp&#34;
	
	
&gt;&lt;/p&gt;
&lt;h2 id=&#34;开始安装&#34;&gt;开始安装
&lt;/h2&gt;&lt;h3 id=&#34;security-manager&#34;&gt;Security-manager
&lt;/h3&gt;&lt;p&gt;1.从 ISO 引导启动，设置完用户名和密码，回车后开始安装系统，安装完成后重启系统。&lt;/p&gt;
&lt;p&gt;2.登录系统，输入用户名和密码，准备开始配置。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/images/so-manager-setup-1.webp&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;so-manager-setup-1.webp&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;3.选择安装类型为distributed&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/images/so-manager-setup-2-choose-install-type.webp&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;so-manager-setup-2-choose-install-type.webp&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;4.选择节点类型为manager&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/images/so-manager-setup-3-choose-node-type.webp&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;so-manager-setup-3-choose-node-type.webp&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;5.选择安装环境为standard，这里需要注意 security-manager 这台主机需要能够联网。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/images/so-manager-setup-4-choose-install-condition.webp&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;so-manager-setup-4-choose-install-condition.webp&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;6.设置主机名&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/images/so-manager-setup-5-set-hostname.webp&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;so-manager-setup-5-set-hostname.webp&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;7.设置管理口，并配置静态地址（这里建议不要选择DHCP分配地址，会影响服务/节点之间的通信）&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/images/so-manager-setup-6-choose-nic.webp&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;so-manager-setup-6-choose-nic.webp&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/images/so-manager-setup-7-set-static-address.webp&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;so-manager-setup-7-set-static-address.webp&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;8.选择系统补丁计划（默认），设置家庭网络（默认）&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/images/so-manager-setup-8-choose-os-path-schedule.webp&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;so-manager-setup-8-choose-os-path-schedule.webp&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/images/so-manager-setup-9-set-home-network.webp&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;so-manager-setup-9-set-home-network.webp&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;9.选择安装类型为高级，进行功能定制化&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/images/so-manager-setup-10-choose-manager-type.webp&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;so-manager-setup-10-choose-manager-type.webp&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;10.设置 ES 集群名称（默认）&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/images/so-manager-setup-11-set-es-cluser-name.webp&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;so-manager-setup-11-set-es-cluser-name.webp&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;11.选择元信息分析引擎（zeek or suricata）。考虑到 zeek 可定制化更强些，所以我选择的是 zeek 处理 metadata，suricata 处理 nids-alerts。事实上，两种方式均可，官方这里有讨论//TODO。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/images/so-manager-setup-12-choose-gen-metadata.webp&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;so-manager-setup-12-choose-gen-metadata.webp&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;12.选择需要发送的日志类型。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;请注意，这指的是需要被发送到 manager 节点的日志类型，不是 zeek 要处理的协议（这需要额外进行配置）&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;建议按照实际监测需求和节点存储容量进行权衡。有选择恐惧症的可以先按默认的来，后面可以再修改的:)。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/images/so-manager-setup-13-choose-logs-to-send.webp&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;so-manager-setup-13-choose-logs-to-send.webp&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;13.选择 IDS 规则集（默认）。你也可以选择高级订阅版。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/images/so-manager-setup-14-choose-ids-ruleset.webp&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;so-manager-setup-14-choose-ids-ruleset.webp&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;14.选择安装的组件列表（默认）。按需选择。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Grafana
&lt;ul&gt;
&lt;li&gt;主机的健康监控和报警&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Fleet &amp;amp; osquery
&lt;ul&gt;
&lt;li&gt;HIDS，侧重于主机信息被动/主动采集&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Wazuh
&lt;ul&gt;
&lt;li&gt;HIDS，侧重于威胁检测、完整性监控等&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;TheHive
&lt;ul&gt;
&lt;li&gt;安全事件响应平台&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Playbook
&lt;ul&gt;
&lt;li&gt;检测 Playbook 的工具&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Strelka
&lt;ul&gt;
&lt;li&gt;文件提取/分析，用于威胁搜索、威胁检测和事件响应&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;/images/so-manager-setup-15-choose-components.webp&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;so-manager-setup-15-choose-components.webp&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;15.为其他组件设置邮箱和密码&lt;/p&gt;
&lt;p&gt;16.选择 WEB 界面的访问方式。我选择的是IP，也可以改为域名方式。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/images/so-manager-setup-16-choose-web-access.webp&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;so-manager-setup-16-choose-web-access.webp&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;17.选择下载系统更新包的方式。建议选择&lt;code&gt;通过 manager 节点下载&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/images/so-manager-setup-17-choose-update-os-by-manager-proxy.webp&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;so-manager-setup-17-choose-update-os-by-manager-proxy.webp&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;18.设置 soremote 密码，后面用于添加其他节点。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/images/so-manager-setup-18-set-soremote-passwd.webp&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;so-manager-setup-18-set-soremote-passwd.webp&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;19.设置允许访问WEB界面的网段。建议只添加安全运维段的主机IP, 不在该网段的主机将无法访问WEB界面。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/images/so-manager-setup-19-set-so-allow.webp&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;so-manager-setup-19-set-so-allow.webp&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;20.确定应用配置，等待完成安装。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/images/so-manager-setup-20.webp&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;so-manager-setup-20.webp&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/images/so-manager-setup-21.webp&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;so-manager-setup-21.webp&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;21.配置防火墙规则，允许其他节点访问管理节点的 Salt 服务 （&lt;strong&gt;重要&lt;/strong&gt;）&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;很多人在部署非管理节点的时候总是提示安装失败，就是因为缺少这个步骤导致的。
sosetup.log中的报错日志类似：&lt;code&gt;[ERROR   ] &#39;mine.send&#39;: False&lt;/code&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;firewall-cmd --permanent --zone&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; --add-port&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;4505-4506/tcp
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;firewall-cmd --reload
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;security-sensor&#34;&gt;Security-sensor
&lt;/h3&gt;&lt;p&gt;1.完成基础的系统安装后，我们开始配置流量分析节点。&lt;/p&gt;
&lt;p&gt;2.选择安装类型为 distributed&lt;/p&gt;
&lt;p&gt;3.选择节点类型为 sensor&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/images/so-sensor-setup-1-choose-install-type.webp&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;so-sensor-setup-1-choose-install-type.webp&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;4.设置主机名&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/images/so-sensor-setup-2-set-hostname.webp&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;so-sensor-setup-2-set-hostname.webp&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;5.选择管理口，并配置静态地址&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/images/so-sensor-setup-3-choose-nic.webp&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;so-sensor-setup-3-choose-nic.webp&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;6.设置 manager 节点，并输入 soremote 密码，与 manager 节点完成连接。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/images/so-sensor-setup-4-set-manager-hostname.webp&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;so-sensor-setup-4-set-manager-hostname.webp&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/images/so-sensor-setup-5-set-manager-ip.webp&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;so-sensor-setup-5-set-manager-ip.webp&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/images/so-sensor-setup-6-connect-to-manager.webp&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;so-sensor-setup-6-connect-to-manager.webp&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;7.选择镜像口&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/images/so-sensor-setup-7-choose-monitor-nic.webp&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;so-sensor-setup-7-choose-monitor-nic.webp&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/images/so-sensor-setup-8.webp&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;so-sensor-setup-8.webp&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;8.选择系统补丁计划（默认），选择下载系统更新包的方式为 manager。&lt;/p&gt;
&lt;p&gt;9.选择安装类型为高级，进行功能定制化。&lt;/p&gt;
&lt;p&gt;10.进行 CPU 绑定（Zeek、Suricata）&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/images/so-sensor-setup-9-bind-cpu-zeek.webp&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;so-sensor-setup-9-bind-cpu-zeek.webp&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/images/so-sensor-setup-10-bind-cpu-surucata.webp&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;so-sensor-setup-10-bind-cpu-surucata.webp&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;11.配置镜像口MTU（默认）&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/images/so-sensor-setup-11-mtu.webp&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;so-sensor-setup-11-mtu.webp&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;12.等待安装完成。&lt;/p&gt;
&lt;h3 id=&#34;security-search&#34;&gt;Security-search
&lt;/h3&gt;&lt;p&gt;1.完成基础的系统安装后，我们开始配置流量分析节点。&lt;/p&gt;
&lt;p&gt;2.选择安装类型为 distributed&lt;/p&gt;
&lt;p&gt;3.选择节点类型为 searchnode&lt;/p&gt;
&lt;p&gt;4.设置主机名&lt;/p&gt;
&lt;p&gt;5.选择管理口，并配置静态地址&lt;/p&gt;
&lt;p&gt;6.设置 manager 节点（输入 soremote 密码）&lt;/p&gt;
&lt;p&gt;7.选择系统补丁计划（默认），选择下载系统更新包的方式为 manager。&lt;/p&gt;
&lt;p&gt;8.选择安装类型为高级，进行功能定制化。&lt;/p&gt;
&lt;p&gt;9.配置 ES 堆大小（默认）&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/images/so-search-setup-1-set-es-heap-size.webp&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;so-search-setup-1-set-es-heap-size.webp&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;10.配置 Logstash 堆大小（默认）&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/images/so-search-setup-2-set-logstash-heap-size.webp&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;so-search-setup-2-set-logstash-heap-size.webp&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;11.配置 Logstash pipeline 线程（默认）&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/images/so-search-setup-3-set-logstash-pipeline-workers.webp&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;so-search-setup-3-set-logstash-pipeline-workers.webp&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;12.配置 logstash pipeline 批处理大小（默认）&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/images/so-search-setup-4-set-logstash-pipeline-batch-size.webp&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;so-search-setup-4-set-logstash-pipeline-batch-size.webp&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;13.配置 logstash input 线程数（默认），如果发现存在消息积压（redis），可以适当调整以上几个参数。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/images/so-search-setup-5-set-logstash-input-num.webp&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;so-search-setup-5-set-logstash-input-num.webp&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;14.配置 ES 索引关闭时间（默认为 30 天）。关闭索引不会删除数据，如果需要查询历史数据可以再单独开启。如果内存足够的话，可以设置为 90 天。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/images/so-search-setup-6-set-days-of-indices-open.webp&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;so-search-setup-6-set-days-of-indices-open.webp&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;15.配置 ES 存储大小，我配置的是 1948（2T-100G），可以择优调整。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/images/so-search-setup-7-set-es-size.webp&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;so-search-setup-7-set-es-size.webp&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;16.等待安装完成。&lt;/p&gt;
&lt;h2 id=&#34;功能验证&#34;&gt;功能验证
&lt;/h2&gt;&lt;p&gt;1.打开 https://10.10.0.1 安全洋葱控制台并登陆&lt;/p&gt;
&lt;p&gt;2.点击 Grid 标签，查看网格状态，检查节点是否已经全部上线。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/images/soc-web-grid.webp&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;soc-web-grid.webp&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;在这里，大家可以看到节点列表中还出现了一个陌生的节点类型 securityonion-fleet，这个是其实是独立部署的 Fleet 服务，由于需要管理的 osquery 客户端较多，容易影响性能，所以就把它从管理节点拆分出来了。&lt;/p&gt;
&lt;p&gt;3.点击 Alerts 标签，检查是否可以正常。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/images/soc-web-alert.webp&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;soc-web-alert.webp&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;4.点击 Hunt 标签，检查是否正常。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/images/soc-web-hunt.webp&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;soc-web-hunt.webp&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;5.点击 Grafana 标签，检查各个主机节点是否正常。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/images/soc-grafana.webp&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;soc-grafana.webp&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;6.点击 Kiabana 标签，检查 ES 服务是否正常。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/images/soc-kibana.webp&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;soc-kibana.webp&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;好了，如果服务一切正常的话，你可以开始打工人生活了:)&lt;/p&gt;
&lt;h2 id=&#34;参考链接&#34;&gt;参考链接
&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a class=&#34;link&#34; href=&#34;https://docs.securityonion.net/en/2.3/about.html&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;https://docs.securityonion.net/en/2.3/about.html&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
        </item>
        
    </channel>
</rss>
